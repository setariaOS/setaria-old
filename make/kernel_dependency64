CPP_SOURCES = $(wildcard *.cc)

dependency:
	g++ -m64 -MM $(CPP_SOURCES) > dependency.dep

entrypoint.cc.o: entrypoint.cc
	g++ -m64 -c $^ -o $@

entrypoint.cc.elf.o: entrypoint.cc.o
	ld -T entrypoint.x86_64.ld -nostdlib -o $@ $^

clean:
	rm -rf dependency.dep
	rm -rf entrypoint.cc.o
	rm -rf entrypoint.cc.elf.o

ifeq (dependency.dep, $(wildcard dependency.dep))
include dependency.dep
endif